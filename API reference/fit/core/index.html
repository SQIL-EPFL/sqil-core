
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../experiment/instruments/">
      
      
        <link rel="next" href="../fit/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Core - SQIL core</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sqil_core.fit._core" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://www.epfl.ch/labs/sqil/research/" title="SQIL core" class="md-header__button md-logo" aria-label="SQIL core" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SQIL core
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.epfl.ch/labs/sqil/research/" title="SQIL core" class="md-nav__button md-logo" aria-label="SQIL core" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    SQIL core
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Notebooks/exp_quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get started with
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Notebooks/fit_output_decorator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The @fit_output decorator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Notebooks/fit_input_decorator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The @fit_input decorator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Notebooks/resonator_fit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fitting resonators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Experiment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Experiment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experiment/handler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Experiment Handler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experiment/analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experiment/instruments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instruments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Fit
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core" class="md-nav__link">
    <span class="md-ellipsis">
      
        _core
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.FitResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        FitResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_adjusted_standard_errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_adjusted_standard_errors
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_aic" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_aic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_chi2" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_chi2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_nrmse" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_nrmse
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.fit_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.fit_output" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_output
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guess
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resonator/resonator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resonator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/read%20data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Read data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/formatter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Formatter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core" class="md-nav__link">
    <span class="md-ellipsis">
      
        _core
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.FitResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        FitResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_adjusted_standard_errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_adjusted_standard_errors
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_aic" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_aic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_chi2" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_chi2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.compute_nrmse" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_nrmse
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.fit_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqil_core.fit._core.fit_output" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_output
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Core</h1>

<div class="doc doc-object doc-module">



<a id="sqil_core.fit._core"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="sqil_core.fit._core.FitResult" class="doc doc-heading">
            <code>FitResult</code>


</h2>


    <div class="doc doc-contents ">



        <p>Stores the result of a fitting procedure.</p>
<p>This class encapsulates the fitted parameters, their standard errors, optimizer
output, and fit quality metrics. It also provides functionality for summarizing
the results and making predictions using the fitted model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of fitted parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>std_err</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of standard errors of the fitted parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit_output</code>
            </td>
            <td>
                  <code><span title="any">any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw output from the optimization routine.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of fit quality metrics (e.g., R-squared, reduced chi-squared).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>predict</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function of x that returns predictions based on the fitted parameters.
If not provided, an exception will be raised when calling it.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_names</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names, defaulting to a range based on the number of parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model used to fit the data.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional information that can be passed in the fit result.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="summary(no_print=False) (sqil_core.fit._core.FitResult.summary)" href="#sqil_core.fit._core.FitResult.summary">summary</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Prints a detailed summary of the fit results, including parameter values,
standard errors, and fit quality metrics.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sqil_core.fit._core.FitResult._no_prediction">_no_prediction</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Raises an exception when no prediction function is available.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">FitResult</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Stores the result of a fitting procedure.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    This class encapsulates the fitted parameters, their standard errors, optimizer</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    output, and fit quality metrics. It also provides functionality for summarizing</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    the results and making predictions using the fitted model.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    params : dict</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        Array of fitted parameters.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    std_err : dict</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        Array of standard errors of the fitted parameters.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    fit_output : any</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        Raw output from the optimization routine.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    metrics : dict, optional</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        Dictionary of fit quality metrics (e.g., R-squared, reduced chi-squared).</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    predict : callable, optional</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        Function of x that returns predictions based on the fitted parameters.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        If not provided, an exception will be raised when calling it.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    param_names : list, optional</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        List of parameter names, defaulting to a range based on the number of parameters</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    model_name : str, optional</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        Name of the model used to fit the data.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    metadata : dict, optional</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Additional information that can be passed in the fit result.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Methods</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    -------</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    summary()</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        Prints a detailed summary of the fit results, including parameter values,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        standard errors, and fit quality metrics.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    _no_prediction()</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        Raises an exception when no prediction function is available.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">std_err</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">fit_output</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">predict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">param_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">model_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_err</span> <span class="o">=</span> <span class="n">std_err</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">fit_output</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">metrics</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span> <span class="o">=</span> <span class="n">predict</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_prediction</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">param_names</span> <span class="o">=</span> <span class="n">param_names</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)))</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="n">model_name</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params_by_name</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="sa">f</span><span class="s2">&quot;FitResult(</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="sa">f</span><span class="s2">&quot;  params=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="sa">f</span><span class="s2">&quot;  std_err=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">std_err</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="sa">f</span><span class="s2">&quot;  metrics=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="si">}</span><span class="se">\n</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no_print</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints a detailed summary of the fit results.&quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">format_fit_metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">s</span> <span class="o">+=</span> <span class="n">format_fit_params</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">std_err</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">std_err</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">no_print</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="o">=</span><span class="s2">&quot;nrmse&quot;</span><span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">return</span> <span class="n">evaluate_fit_quality</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">recipe</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_acceptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="o">=</span><span class="s2">&quot;nrmse&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">FitQuality</span><span class="o">.</span><span class="n">ACCEPTABLE</span><span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">threshold</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_no_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No predition function available&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="sqil_core.fit._core.FitResult.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">no_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prints a detailed summary of the fit results.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no_print</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints a detailed summary of the fit results.&quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">format_fit_metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">s</span> <span class="o">+=</span> <span class="n">format_fit_params</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_err</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">std_err</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_print</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.compute_adjusted_standard_errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_adjusted_standard_errors</span><span class="p">(</span><span class="n">pcov</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">red_chi2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov_rescaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute adjusted standard errors for fitted parameters.</p>
<p>This function adjusts the covariance matrix based on the reduced chi-squared
value and calculates the standard errors for each parameter. It accounts for
cases where the covariance matrix is not available or the fit is nearly perfect.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pcov</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Covariance matrix of the fitted parameters, typically obtained from an
optimization routine.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>residuals</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals of the fit, defined as the difference between observed and
model-predicted values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>red_chi2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precomputed reduced chi-squared value. If <code>None</code>, it is computed from
<code>residuals</code> and <code>sigma</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cov_rescaled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fitting process already rescales the covariance matrix with
the reduced chi-squared.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental uncertainties. Only used if <code>cov_rescaled=False</code> AND
known experimental errors are available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard errors for each fitted parameter. If the covariance matrix is
undefined, returns <code>None</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="warning" open>
  <summary>Warnings</summary>
  <ul>
<li>If the covariance matrix is not available (<code>pcov is None</code>), the function
  issues a warning about possible numerical instability or a near-perfect fit.</li>
<li>If the reduced chi-squared value is <code>NaN</code>, the function returns <code>NaN</code> for
  all standard errors.</li>
</ul>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The covariance matrix is scaled by the reduced chi-squared value to adjust
  for under- or overestimation of uncertainties.</li>
<li>If <code>red_chi2</code> is not provided, it is computed internally using the residuals.</li>
<li>If a near-perfect fit is detected (all residuals close to zero), the function
  warns that standard errors may not be necessary.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pcov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">]])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_adjusted_standard_errors</span><span class="p">(</span><span class="n">pcov</span><span class="p">,</span> <span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">array([0.2, 0.3])</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_adjusted_standard_errors</span><span class="p">(</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="n">pcov</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="n">residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="n">red_chi2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="n">cov_rescaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    Compute adjusted standard errors for fitted parameters.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    This function adjusts the covariance matrix based on the reduced chi-squared</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    value and calculates the standard errors for each parameter. It accounts for</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    cases where the covariance matrix is not available or the fit is nearly perfect.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    pcov : np.ndarray</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        Covariance matrix of the fitted parameters, typically obtained from an</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        optimization routine.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    residuals : np.ndarray</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        Residuals of the fit, defined as the difference between observed and</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        model-predicted values.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    red_chi2 : float, optional</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        Precomputed reduced chi-squared value. If `None`, it is computed from</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        `residuals` and `sigma`.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    cov_rescaled : bool, default=True</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        Whether the fitting process already rescales the covariance matrix with</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        the reduced chi-squared.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    sigma : np.ndarray, optional</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Experimental uncertainties. Only used if `cov_rescaled=False` AND</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        known experimental errors are available.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">    -------</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Standard errors for each fitted parameter. If the covariance matrix is</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        undefined, returns `None`.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    Warnings</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    --------</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    - If the covariance matrix is not available (`pcov is None`), the function</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">      issues a warning about possible numerical instability or a near-perfect fit.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    - If the reduced chi-squared value is `NaN`, the function returns `NaN` for</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">      all standard errors.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">    -----</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    - The covariance matrix is scaled by the reduced chi-squared value to adjust</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">      for under- or overestimation of uncertainties.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    - If `red_chi2` is not provided, it is computed internally using the residuals.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    - If a near-perfect fit is detected (all residuals close to zero), the function</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">      warns that standard errors may not be necessary.</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    --------</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    &gt;&gt;&gt; pcov = np.array([[0.04, 0.01], [0.01, 0.09]])</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    &gt;&gt;&gt; residuals = np.array([0.1, -0.2, 0.15])</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    &gt;&gt;&gt; compute_adjusted_standard_errors(pcov, residuals)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    array([0.2, 0.3])</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="c1"># Check for invalid covariance</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="k">if</span> <span class="n">pcov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="s2">&quot;Covariance matrix could not be estimated due to an almost perfect fit.&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                <span class="s2">&quot; Standard errors are undefined but may not be necessary in this case.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                <span class="s2">&quot;Covariance matrix could not be estimated. This could be due to poor&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="s2">&quot;model fit or numerical instability. &quot;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                <span class="s2">&quot;Review the data or model configuration.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="c1"># Calculate reduced chi-squared</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">n_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="k">if</span> <span class="n">red_chi2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">_</span><span class="p">,</span> <span class="n">red_chi2</span> <span class="o">=</span> <span class="n">compute_chi2</span><span class="p">(</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">residuals</span><span class="p">,</span> <span class="n">n_params</span><span class="p">,</span> <span class="n">cov_rescaled</span><span class="o">=</span><span class="n">cov_rescaled</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="p">)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="c1"># Rescale the covariance matrix</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">red_chi2</span><span class="p">):</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">pcov_rescaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">pcov_rescaled</span> <span class="o">=</span> <span class="n">pcov</span> <span class="o">*</span> <span class="n">red_chi2</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="c1"># Calculate standard errors for each parameter</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pcov_rescaled</span><span class="p">)):</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">standard_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_params</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="n">standard_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov_rescaled</span><span class="p">))</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">return</span> <span class="n">standard_errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.compute_aic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_aic</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">n_params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Akaike Information Criterion (AIC) for a given model fit.</p>
<p>The AIC is a metric used to compare the relative quality of statistical models
for a given dataset. It balances model fit with complexity, penalizing models
with more parameters to prevent overfitting.</p>
<p>Interpretation: The AIC has no maeaning on its own, only the difference between
the AIC of model1 and the one of model2.
AIC = AIC_1 - AIC_2
If AIC &gt; 10 -&gt; model 2 fits much better.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>residuals</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of residuals between the observed data and model predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_params</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of free parameters in the fitted model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Akaike Information Criterion value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_aic</span><span class="p">(</span><span class="n">residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">n_params</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    Computes the Akaike Information Criterion (AIC) for a given model fit.</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    The AIC is a metric used to compare the relative quality of statistical models</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    for a given dataset. It balances model fit with complexity, penalizing models</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    with more parameters to prevent overfitting.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">    Interpretation: The AIC has no maeaning on its own, only the difference between</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    the AIC of model1 and the one of model2.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    AIC = AIC_1 - AIC_2</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">    If AIC &gt; 10 -&gt; model 2 fits much better.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    residuals : np.ndarray</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        Array of residuals between the observed data and model predictions.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">    n_params : int</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        Number of free parameters in the fitted model.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">    -------</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">    float</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        The Akaike Information Criterion value.</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="n">rss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n_params</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rss</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.compute_chi2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_chi2</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">n_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov_rescaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the chi-squared () and reduced chi-squared (_red) statistics.</p>
<p>This function calculates the chi-squared value based on residuals and an
estimated or provided uncertainty (<code>sigma</code>). If the number of model parameters
(<code>n_params</code>) is specified, it also computes the reduced chi-squared.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>residuals</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The difference between observed and model-predicted values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_params</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of fitted parameters. If provided, the function also computes
the reduced chi-squared (_red).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cov_rescaled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the covariance matrix has been already rescaled by the fit method.
If <code>True</code>, the function assumes proper uncertainty scaling. Otherwise,
it estimates uncertainty from the standard deviation of the residuals.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental uncertainties. Should only be used when the fitting process
does not account for experimental errors AND known uncertainties are available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>chi2</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chi-squared statistic (), which measures the goodness of fit.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>red_chi2</code></td>            <td>
                  <code>float (if `n_params` is provided)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reduced chi-squared statistic (_red), computed as  divided by
the degrees of freedom (N - p). If <code>n_params</code> is <code>None</code>, only  is returned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="warning" open>
  <summary>Warnings</summary>
  <ul>
<li>If the degrees of freedom (N - p) is non-positive, a warning is issued,
  and _red is set to NaN. This may indicate overfitting or an insufficient
  number of data points.</li>
<li>If any uncertainty value in <code>sigma</code> is zero, it is replaced with machine epsilon
  to prevent division by zero.</li>
</ul>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>sigma</code> is not provided and <code>cov_rescaled=False</code>, the function estimates
  the uncertainty using the standard deviation of residuals.</li>
<li>The reduced chi-squared value (_red) should ideally be close to 1 for a good fit
  Values significantly greater than 1 indicate underfitting, while values much less
  than 1 suggest overfitting.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_chi2</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">n_params</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">(0.085, 0.0425)  # Example output</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_chi2</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">n_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov_rescaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Compute the chi-squared () and reduced chi-squared (_red) statistics.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    This function calculates the chi-squared value based on residuals and an</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    estimated or provided uncertainty (`sigma`). If the number of model parameters</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    (`n_params`) is specified, it also computes the reduced chi-squared.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    residuals : np.ndarray</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        The difference between observed and model-predicted values.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    n_params : int, optional</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        Number of fitted parameters. If provided, the function also computes</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        the reduced chi-squared (_red).</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    cov_rescaled : bool, default=True</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        Whether the covariance matrix has been already rescaled by the fit method.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        If `True`, the function assumes proper uncertainty scaling. Otherwise,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        it estimates uncertainty from the standard deviation of the residuals.</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    sigma : np.ndarray, optional</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        Experimental uncertainties. Should only be used when the fitting process</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        does not account for experimental errors AND known uncertainties are available.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    -------</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    chi2 : float</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        The chi-squared statistic (), which measures the goodness of fit.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    red_chi2 : float (if `n_params` is provided)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        The reduced chi-squared statistic (_red), computed as  divided by</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        the degrees of freedom (N - p). If `n_params` is `None`, only  is returned.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    Warnings</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">    --------</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    - If the degrees of freedom (N - p) is non-positive, a warning is issued,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">      and _red is set to NaN. This may indicate overfitting or an insufficient</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">      number of data points.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">    - If any uncertainty value in `sigma` is zero, it is replaced with machine epsilon</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">      to prevent division by zero.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    -----</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    - If `sigma` is not provided and `cov_rescaled=False`, the function estimates</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">      the uncertainty using the standard deviation of residuals.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">    - The reduced chi-squared value (_red) should ideally be close to 1 for a good fit</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">      Values significantly greater than 1 indicate underfitting, while values much less</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">      than 1 suggest overfitting.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    --------</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    &gt;&gt;&gt; residuals = np.array([0.1, -0.2, 0.15, -0.05])</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    &gt;&gt;&gt; compute_chi2(residuals, n_params=2)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    (0.085, 0.0425)  # Example output</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="c1"># If the optimization does not account for th experimental sigma,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="c1"># approximate it with the std of the residuals</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="n">S</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">cov_rescaled</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="c1"># If the experimental error is provided, use that instead</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">sigma</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="c1"># Replace 0 elements of S with the machine epsilon to avoid divisions by 0</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="n">S_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">S</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">S_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="k">if</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">S</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="c1"># Compute chi squared</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="n">chi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">residuals</span> <span class="o">/</span> <span class="n">S_safe</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="c1"># If number of parameters is not provided return just chi2</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">if</span> <span class="n">n_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="k">return</span> <span class="n">chi2</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="c1"># Reduced chi squared</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="n">dof</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_params</span>  <span class="c1"># degrees of freedom (N - p)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="k">if</span> <span class="n">dof</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>            <span class="s2">&quot;Degrees of freedom (dof) is non-positive. &quot;</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="s2">&quot;This may indicate overfitting or insufficient data.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="p">)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">red_chi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">red_chi2</span> <span class="o">=</span> <span class="n">chi2</span> <span class="o">/</span> <span class="n">dof</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">return</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">red_chi2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.compute_nrmse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_nrmse</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Normalized Root Mean Squared Error (NRMSE) of a model fit.</p>
<p>Lower is better.</p>
<p>The NRMSE is a scale-independent metric that quantifies the average magnitude
of residual errors normalized by the range of the observed data. It is useful
for comparing the fit quality across different datasets or models.</p>
<p>For complex data it's computed using the L2 norm and the span of the magnitude.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>residuals</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of residuals between the observed data and model predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_data</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original observed data used in the model fitting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The normalized root mean squared error (NRMSE).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_nrmse</span><span class="p">(</span><span class="n">residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    Computes the Normalized Root Mean Squared Error (NRMSE) of a model fit.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">    Lower is better.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">    The NRMSE is a scale-independent metric that quantifies the average magnitude</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">    of residual errors normalized by the range of the observed data. It is useful</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    for comparing the fit quality across different datasets or models.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">    For complex data it&#39;s computed using the L2 norm and the span of the magnitude.</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">    residuals : np.ndarray</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        Array of residuals between the observed data and model predictions.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    y_data : np.ndarray</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        The original observed data used in the model fitting.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    -------</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    float</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        The normalized root mean squared error (NRMSE).</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">y_data</span><span class="p">):</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">y_abs_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_data</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_data</span><span class="p">))</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">if</span> <span class="n">y_abs_span</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>                <span class="s2">&quot;y_data has zero span in magnitude. NRMSE is undefined.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                <span class="ne">RuntimeWarning</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">nrmse</span> <span class="o">=</span> <span class="n">rmse</span> <span class="o">/</span> <span class="n">y_abs_span</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">y_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="k">if</span> <span class="n">y_span</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                <span class="s2">&quot;y_data has zero span. NRMSE is undefined.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>                <span class="ne">RuntimeWarning</span><span class="p">,</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">rss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">nrmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rss</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_span</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="k">return</span> <span class="n">nrmse</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.fit_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_input</span><span class="p">(</span><span class="n">fit_func</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decorator to handle optional fitting inputs like initial guesses, bounds, and fixed parameters
for a fitting function.</p>
<ul>
<li><code>guess</code> : list or np.ndarray, optional, default=None
    The initial guess for the fit. If None it's not passed to the fit function.</li>
<li><code>bounds</code> : list or np.ndarray, optional, default=(-np.inf, np.inf)
    The bounds on the fit parameters in the form [(min, max), (min, max), ...].</li>
<li><code>fixed_params</code> : list or np.ndarray, optional, default=None
    Indices of the parameters that must remain fixed during the optimization.
    For example fitting <code>f(x, a, b)</code>, if we want to fix the value of <code>a</code> we would pass
    <code>fit_f(guess=[a_guess, b_guess], fixed_params=[0])</code></li>
<li><code>fixed_bound_factor</code> : float, optional, default=1e-6
    The relative tolerance allowed for parameters that must remain fixed (<code>fixed_params</code>).</li>
</ul>
<p>IMPORTANT: This decorator requires the x and y input vectors to be named <code>x_data</code> and <code>y_data</code>.
    The initial guess must be called <code>guess</code> and the bounds <code>bounds</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fit_func</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fitting function to be decorated. This function should accept <code>x_data</code> and <code>y_data</code> as
mandatory parameters and may optionally accept <code>guess</code> and <code>bounds</code> (plus any other additional
parameter).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A wrapper function that processes the input arguments and then calls the original fitting
function with the preprocessed inputs. This function also handles warnings if unsupported
parameters are passed to the fit function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The parameters in <code>guess</code>, <code>bounds</code> and <code>fixed_params</code> must be in the same order as in the
  modeled function definition.</li>
<li>The decorator can fix certain parameters by narrowing their bounds based on an initial guess
  and a specified <code>fixed_bound_factor</code>.</li>
<li>The decorator processes bounds by setting them as <code>(-np.inf, np.inf)</code> if they are not specified (<code>None</code>).</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="nd">@fit_input</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_fit_func</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="c1"># Perform fitting...</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="k">return</span> <span class="n">fit_result</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">my_fit_func</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)])</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_input</span><span class="p">(</span><span class="n">fit_func</span><span class="p">):</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    Decorator to handle optional fitting inputs like initial guesses, bounds, and fixed parameters</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    for a fitting function.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    - `guess` : list or np.ndarray, optional, default=None</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        The initial guess for the fit. If None it&#39;s not passed to the fit function.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    - `bounds` : list or np.ndarray, optional, default=(-np.inf, np.inf)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        The bounds on the fit parameters in the form [(min, max), (min, max), ...].</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    - `fixed_params` : list or np.ndarray, optional, default=None</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Indices of the parameters that must remain fixed during the optimization.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        For example fitting `f(x, a, b)`, if we want to fix the value of `a` we would pass</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        `fit_f(guess=[a_guess, b_guess], fixed_params=[0])`</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    - `fixed_bound_factor` : float, optional, default=1e-6</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        The relative tolerance allowed for parameters that must remain fixed (`fixed_params`).</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    IMPORTANT: This decorator requires the x and y input vectors to be named `x_data` and `y_data`.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        The initial guess must be called `guess` and the bounds `bounds`.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    fit_func : callable</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        The fitting function to be decorated. This function should accept `x_data` and `y_data` as</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        mandatory parameters and may optionally accept `guess` and `bounds` (plus any other additional</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        parameter).</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    -------</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    callable</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        A wrapper function that processes the input arguments and then calls the original fitting</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        function with the preprocessed inputs. This function also handles warnings if unsupported</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        parameters are passed to the fit function.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    -----</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    - The parameters in `guess`, `bounds` and `fixed_params` must be in the same order as in the</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">      modeled function definition.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    - The decorator can fix certain parameters by narrowing their bounds based on an initial guess</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">      and a specified `fixed_bound_factor`.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    - The decorator processes bounds by setting them as `(-np.inf, np.inf)` if they are not specified (`None`).</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    -------</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    &gt;&gt;&gt; @fit_input</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    ... def my_fit_func(x_data, y_data, guess=None, bounds=None, fixed_params=None):</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    ...     # Perform fitting...</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    ...     return fit_result</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    &gt;&gt;&gt; x_data = np.linspace(0, 10, 100)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    &gt;&gt;&gt; y_data = np.sin(x_data) + np.random.normal(0, 0.1, 100)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    &gt;&gt;&gt; result = my_fit_func(x_data, y_data, guess=[1, 1], bounds=[(0, 5), (-np.inf, np.inf)])</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fit_func</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="o">*</span><span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">fixed_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">fixed_bound_factor</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="p">):</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="c1"># Inspect function to check if it requires guess and bounds</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">func_params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">fit_func</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="c1"># Check if the user passed parameters that are not supported by the fit fun</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">guess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;guess&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">func_params</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="s2">&quot;The fit function doesn&#39;t allow any initial guess.&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;bounds&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">func_params</span><span class="p">):</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The fit function doesn&#39;t allow any bounds.&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fixed_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">guess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Using fixed_params requires an initial guess.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="c1"># Process bounds if the function accepts it</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;bounds&quot;</span> <span class="ow">in</span> <span class="n">func_params</span><span class="p">):</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">processed_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="p">[(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">],</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="n">processed_bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="n">processed_bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="c1"># Fix parameters by setting a very tight bound</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fixed_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">guess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="n">lower_bounds</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">guess</span><span class="p">))</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">guess</span><span class="p">))</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">fixed_params</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="n">tolerance</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                    <span class="nb">abs</span><span class="p">(</span><span class="n">guess</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> <span class="o">*</span> <span class="n">fixed_bound_factor</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>                    <span class="k">if</span> <span class="n">guess</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                    <span class="k">else</span> <span class="n">fixed_bound_factor</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="n">lower_bounds</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">guess</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">tolerance</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">upper_bounds</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">guess</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">tolerance</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="c1"># Prepare arguments dynamically</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">fit_args</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">if</span> <span class="n">guess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;guess&quot;</span> <span class="ow">in</span> <span class="n">func_params</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="n">fit_args</span><span class="p">[</span><span class="s2">&quot;guess&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">guess</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;bounds&quot;</span> <span class="ow">in</span> <span class="n">func_params</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">fit_args</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="c1"># Call the wrapped function with preprocessed inputs</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">fit_args</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_args</span><span class="p">}</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">return</span> <span class="n">fit_func</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_args</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sqil_core.fit._core.fit_output" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_output</span><span class="p">(</span><span class="n">fit_func</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decorator to standardize the output of fitting functions.</p>
<p>This decorator processes the raw output of various fitting libraries
(such as SciPy's curve_fit, least_squares leastsq, and minimize, as well as lmfit)
and converts it into a unified <code>FitResult</code> object. It extracts
optimized parameters, their standard errors, fit quality metrics,
and a prediction function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fit_func</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that performs fitting and returns raw fit output,
possibly along with metadata.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A wrapped function that returns a <code>FitResult</code> object containing:
- <code>params</code> : list
    Optimized parameter values.
- <code>std_err</code> : list or None
    Standard errors of the fitted parameters.
- <code>metrics</code> : dict or None
    Dictionary of fit quality metrics (e.g., reduced chi-squared).
- <code>predict</code> : Callable or None
    A function that predicts values using the optimized parameters.
- <code>output</code> : object
    The raw optimizer output from the fitting process.
- <code>param_names</code> : list or None
    Names of the fitted parameters.
- <code>metadata</code> : dict
    A dictionary containing extra information. Advanced uses include passing
    functions that get evaluated after fit result has been processed.
    See the documentation, Notebooks/The fit_output decorator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the fitting function's output format is not recognized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>If the fit function returns a tuple <code>(raw_output, metadata)</code>,
  the metadata is extracted and applied to enhance the fit results.
  In case of any conflicts, the metadata overrides the computed values.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="nd">@fit_output</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_fitting_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="k">return</span> <span class="n">some_raw_fit_output</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">...</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_result</span> <span class="o">=</span> <span class="n">my_fitting_function</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fit_result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sqil_core/fit/_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_output</span><span class="p">(</span><span class="n">fit_func</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    Decorator to standardize the output of fitting functions.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    This decorator processes the raw output of various fitting libraries</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    (such as SciPy&#39;s curve_fit, least_squares leastsq, and minimize, as well as lmfit)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    and converts it into a unified `FitResult` object. It extracts</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    optimized parameters, their standard errors, fit quality metrics,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    and a prediction function.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    fit_func : Callable</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        A function that performs fitting and returns raw fit output,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        possibly along with metadata.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    -------</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Callable</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        A wrapped function that returns a `FitResult` object containing:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        - `params` : list</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            Optimized parameter values.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        - `std_err` : list or None</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            Standard errors of the fitted parameters.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        - `metrics` : dict or None</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            Dictionary of fit quality metrics (e.g., reduced chi-squared).</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        - `predict` : Callable or None</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            A function that predicts values using the optimized parameters.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        - `output` : object</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            The raw optimizer output from the fitting process.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        - `param_names` : list or None</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            Names of the fitted parameters.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        - `metadata` : dict</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            A dictionary containing extra information. Advanced uses include passing</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            functions that get evaluated after fit result has been processed.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            See the documentation, Notebooks/The fit_output decorator</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    ------</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    TypeError</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        If the fitting function&#39;s output format is not recognized.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    -----</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    - If the fit function returns a tuple `(raw_output, metadata)`,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">      the metadata is extracted and applied to enhance the fit results.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">      In case of any conflicts, the metadata overrides the computed values.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    --------</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &gt;&gt;&gt; @fit_output</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    ... def my_fitting_function(x, y):</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    ...     return some_raw_fit_output</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    ...</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &gt;&gt;&gt; fit_result = my_fitting_function(x_data, y_data)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    &gt;&gt;&gt; print(fit_result.params)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fit_func</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="c1"># Perform the fit</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">fit_result</span> <span class="o">=</span> <span class="n">fit_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="c1"># Extract information from function arguments</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">_get_xy_data_from_fit_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">has_sigma</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="c1"># Initilize variables</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">sqil_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="s2">&quot;std_err&quot;</span><span class="p">,</span> <span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="s2">&quot;predict&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="s2">&quot;param_names&quot;</span><span class="p">]</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">sqil_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sqil_keys</span><span class="p">}</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">formatted</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="c1"># Set the default parameters to an empty array instead of None</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="c1"># Check if the fit output is a tuple and separate it into raw_fit_ouput</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># and metadata</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fit_result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="p">):</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">raw_fit_output</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">fit_result</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">raw_fit_output</span> <span class="o">=</span> <span class="n">fit_result</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_fit_output</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="c1"># Check if there are variables to override in metadata before continuing</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">if</span> <span class="s2">&quot;fit_output_vars&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">overrides</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;fit_output_vars&quot;</span><span class="p">]</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">x_data</span> <span class="o">=</span> <span class="n">overrides</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;x_data&quot;</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">y_data</span> <span class="o">=</span> <span class="n">overrides</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;y_data&quot;</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="k">del</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;fit_output_vars&quot;</span><span class="p">]</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="c1"># Format the raw_fit_output into a standardized dict</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">if</span> <span class="n">raw_fit_output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Fit didn&#39;t coverge, result is None&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="c1"># Scipy tuple (curve_fit, leastsq)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">if</span> <span class="n">_is_scipy_tuple</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">formatted</span> <span class="o">=</span> <span class="n">_format_scipy_tuple</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">has_sigma</span><span class="o">=</span><span class="n">has_sigma</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="c1"># Scipy least squares</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">elif</span> <span class="n">_is_scipy_least_squares</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">):</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">formatted</span> <span class="o">=</span> <span class="n">_format_scipy_least_squares</span><span class="p">(</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">raw_fit_output</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">has_sigma</span><span class="o">=</span><span class="n">has_sigma</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="c1"># Scipy minimize</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">elif</span> <span class="n">_is_scipy_minimize</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="n">predict</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;predict&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">x_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">predict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">predict</span><span class="p">):</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_data</span> <span class="o">-</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">](</span><span class="n">x_data</span><span class="p">,</span> <span class="o">*</span><span class="n">raw_fit_output</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="n">formatted</span> <span class="o">=</span> <span class="n">_format_scipy_minimize</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="n">raw_fit_output</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">y_data</span><span class="o">=</span><span class="n">y_data</span><span class="p">,</span> <span class="n">has_sigma</span><span class="o">=</span><span class="n">has_sigma</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="c1"># lmfit</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">elif</span> <span class="n">_is_lmfit</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">):</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">formatted</span> <span class="o">=</span> <span class="n">_format_lmfit</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="c1"># Custom fit output</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_fit_output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="n">formatted</span> <span class="o">=</span> <span class="n">raw_fit_output</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="s2">&quot;Couldn&#39;t recognize the output.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="o">+</span> <span class="s2">&quot;Are you using scipy? Did you forget to set `full_output=True` &quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="s2">&quot;in your fit method?&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="c1"># Update sqil_dict with the formatted fit_output</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">if</span> <span class="n">formatted</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">sqil_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="c1"># Add/override fileds using metadata</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">sqil_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># Process metadata</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">metadata</span> <span class="o">=</span> <span class="n">_process_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">sqil_dict</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="c1"># Remove fields already present in sqil_dict from metadata</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">filtered_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sqil_keys</span><span class="p">}</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="c1"># Assign the optimized parameters to the prediction function</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">model_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="n">params</span> <span class="o">=</span> <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="n">predict</span> <span class="o">=</span> <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">n_inputs</span> <span class="o">=</span> <span class="n">_count_function_parameters</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="k">if</span> <span class="n">n_inputs</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="n">sqil_dict</span><span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="k">return</span> <span class="n">FitResult</span><span class="p">(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">params</span><span class="o">=</span><span class="n">sqil_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="p">[]),</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">std_err</span><span class="o">=</span><span class="n">sqil_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;std_err&quot;</span><span class="p">),</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="n">fit_output</span><span class="o">=</span><span class="n">raw_fit_output</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">metrics</span><span class="o">=</span><span class="n">sqil_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="p">{}),</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">predict</span><span class="o">=</span><span class="n">sqil_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;predict&quot;</span><span class="p">),</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">param_names</span><span class="o">=</span><span class="n">sqil_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;param_names&quot;</span><span class="p">),</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">filtered_metadata</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>